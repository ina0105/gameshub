<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Personalized Crossword</title>
  <style>
    body {
      font-family: 'Helvetica Neue', Arial, sans-serif;
      max-width: 1000px;
      margin: 0 auto;
      padding: 20px;
      background-color: #f9f9f9;
    }
    
    .header {
      text-align: center;
      margin-bottom: 20px;
    }
    
    h1 {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 5px;
    }
    
    .container {
      display: flex;
      flex-direction: row;
      gap: 20px;
      max-width: 100%;
    }
    
    @media (max-width: 768px) {
      .container {
        flex-direction: column;
      }
    }
    
    .crossword-container {
      flex: 1;
      min-width: 0;
    }
    
    .clues-container {
      flex: 1;
      min-width: 0;
      display: flex;
      flex-direction: column;
    }
    
    .grid {
      display: grid;
      grid-template-columns: repeat(19, 35px);
      grid-template-rows: repeat(21, 35px);
      gap: 1px;
      border: 2px solid #000;
      background-color: #000;
      max-width: 100%;
      overflow-x: auto;
    }
    
    .cell {
      background-color: white;
      border: 1px solid #ccc;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
      font-size: 20px;
      font-weight: bold;
      cursor: pointer;
      user-select: none;
    }
    
    .black {
      background-color: #000;
    }
    
    .number {
      position: absolute;
      top: 1px;
      left: 2px;
      font-size: 10px;
      font-weight: normal;
      z-index: 1;
    }
    
    .input-cell {
      width: 90%;
      height: 90%;
      border: none;
      text-align: center;
      font-size: 20px;
      font-weight: bold;
      text-transform: uppercase;
      background: transparent;
    }
    
    .input-cell:focus {
      outline: none;
      background-color: #e6f2ff;
    }
    
    .highlight {
      background-color: #e6f2ff;
    }
    
    .highlight-current {
      background-color: #ffda00;
    }
    
    .clues-section {
      margin-bottom: 20px;
      border: 1px solid #ccc;
      padding: 10px;
      border-radius: 5px;
      background-color: white;
      overflow-y: auto;
      max-height: 300px;
    }
    
    .clues-heading {
      font-weight: bold;
      font-size: 18px;
      margin-bottom: 10px;
      border-bottom: 1px solid #ccc;
      padding-bottom: 5px;
    }
    
    .clue {
      margin-bottom: 8px;
      cursor: pointer;
      padding: 5px;
    }
    
    .clue:hover {
      background-color: #f0f0f0;
    }
    
    .clue-selected {
      background-color: #e6f2ff;
      font-weight: bold;
    }
    
    .clue-number {
      font-weight: bold;
      margin-right: 8px;
    }
    
    .controls {
      display: flex;
      justify-content: center;
      margin: 20px 0;
    }
    
    button {
      margin: 0 10px;
      padding: 8px 16px;
      background-color: #000;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
    }
    
    button:hover {
      background-color: #333;
    }
    
    .completed {
      background-color: #d4edda;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>Personalized Crossword</h1>
  </div>
  
  <div class="container">
    <div class="crossword-container">
      <div class="grid" id="crosswordGrid"></div>
      
      <div class="controls">
        <button id="checkButton">Check</button>
        <button id="revealButton">Reveal</button>
        <button id="clearButton">Clear</button>
      </div>
    </div>
    
    <div class="clues-container">
      <div class="clues-section">
        <div class="clues-heading">Across</div>
        <div id="acrossClues"></div>
      </div>
      
      <div class="clues-section">
        <div class="clues-heading">Down</div>
        <div id="downClues"></div>
      </div>
    </div>
  </div>
  
  <script>
    // Crossword data
    const gridData = [
      [null, null, null, 'S', null, null, 'L', null, null, null, null, null, null, null, null, null, 'R', null, null],
      [null, null, null, 'U', null, 'G', 'H', 'O', 'S', 'T', 'I', 'N', 'G', null, null, null, 'A', null, null],
      [null, null, null, 'R', null, null, null, null, 'R', null, null, null, null, null, null, null, 'P', 'E', 'R'],
      ['W', 'E', 'S', 'A', 'N', 'D', 'E', 'R', 'S', 'O', 'N', null, null, null, null, null, 'U', null, null],
      [null, 'B', null, null, null, null, 'O', null, null, null, null, null, null, null, null, null, 'N', null, null],
      [null, 'U', null, null, null, null, 'F', null, null, null, null, null, null, null, null, null, 'Z', null, null],
      [null, 'D', null, null, null, null, 'T', null, 'I', null, null, null, null, null, null, null, 'E', null, null],
      [null, 'D', null, 'J', 'O', 'H', 'N', 'N', 'Y', 'E', 'N', 'G', 'L', 'I', 'S', 'H', null, null, null],
      [null, 'Y', null, null, null, null, 'E', null, 'A', null, null, null, null, null, null, null, null, null, null],
      [null, null, null, null, null, null, 'R', null, null, null, null, null, 'T', null, null, null, null, null, null],
      ['C', 'I', 'N', 'E', 'M', 'A', 'P', 'A', 'R', 'A', 'D', 'I', 'S', 'O', null, null, null, null, null],
      [null, 'N', null, null, null, null, null, null, 'U', null, null, 'Z', null, null, null, null, null, null, null],
      ['P', 'I', 'N', 'G', 'U', 'I', 'N', null, null, null, 'F', null, 'I', null, null, null, null, null, null],
      ['A', null, null, null, 'S', null, null, null, null, null, 'F', null, 'P', null, null, null, null, null, null],
      ['Z', null, null, null, null, 'C', null, null, null, null, 'L', 'U', 'C', 'I', 'J', 'A', null, null, null],
      ['I', null, null, null, null, 'A', null, null, null, null, 'E', null, 'Z', null, null, null, null, null, null],
      [null, 'W', 'E', 'T', 'D', 'R', 'E', 'A', 'M', 'S', null, 'I', null, null, null, null, null, null, null],
      [null, null, 'M', null, null, 'S', null, null, null, 'A', null, null, null, null, null, null, null, null, null],
      ['H', 'U', 'R', 'K', 'A', 'C', 'Z', null, 'B', null, 'P', null, 'Y', null, null, null, null, null, null],
      [null, null, 'Y', null, null, null, 'A', null, 'I', null, 'O', null, null, null, null, null, null, null, null],
      [null, 'B', 'U', 'Z', 'Z', 'C', 'U', 'T', null, null, null, null, null, null, null, null, null, null, null],
      ['P', 'E', 'P', 'E', null, null, 'K', null, 'A', null, null, null, null, null, null, null, null, null, null]
    ];
    
    const numberedCells = [
      { row: 0, col: 3, across: 1, down: 1 },
      { row: 0, col: 6, across: 2, down: null },
      { row: 0, col: 16, across: 3, down: 3 },
      { row: 1, col: 5, across: 4, down: null },
      { row: 3, col: 0, across: 5, down: null },
      { row: 6, col: 8, across: null, down: 7 },
      { row: 7, col: 3, across: 8, down: null },
      { row: 9, col: 12, across: null, down: 9 },
      { row: 10, col: 0, across: 10, down: null },
      { row: 12, col: 0, across: 13, down: null },
      { row: 14, col: 5, across: null, down: 14 },
      { row: 14, col: 10, across: 15, down: null },
      { row: 16, col: 1, across: 17, down: null },
      { row: 17, col: 2, across: null, down: 18 },
      { row: 18, col: 0, across: 19, down: null },
      { row: 18, col: 8, across: null, down: 20 },
      { row: 18, col: 10, across: null, down: 21 },
      { row: 20, col: 1, across: 22, down: null },
      { row: 20, col: 0, across: 23, down: null }
    ];
    
    const acrossClues = [
      { number: 1, clue: "What is your stupid stress coping mechanism" },
      { number: 4, clue: "What is your stupid stress coping mechanism" },
      { number: 5, clue: "My actual favorite sweet treat" },
      { number: 6, clue: "Who is my favorite director" },
      { number: 8, clue: "What was the first movie we watched together" },
      { number: 10, clue: "What I think is your favorite movie" },
      { number: 12, clue: "My favorite sweet treat" },
      { number: 14, clue: "What is the name of my friend from Croatia that is a data scientist" },
      { number: 15, clue: "The song with which I told you I was a V" },
      { number: 17, clue: "The name of the polish player we watched in Rotterdam" },
      { number: 19, clue: "I would dye my hair blonde if you got a ___" },
      { number: 20, clue: "How does my dad call you" }
    ];
    
    const downClues = [
      { number: 1, clue: "What you tell me when you ___" },
      { number: 2, clue: "What you say is your favorite ___" },
      { number: 3, clue: "What was the first cartoon we watched together" },
      { number: 7, clue: "Who was the initial rizzler" },
      { number: 9, clue: "What was the first thing I had to eat bc of you" },
      { number: 11, clue: "What is the name of the sunglasses brand everybody in Croatia wears" },
      { number: 12, clue: "What was the first Croatian word you learned" },
      { number: 13, clue: "Where was our first date" },
      { number: 16, clue: "What you say when I ask you to come to Ams a day earlier" },
      { number: 18, clue: "What is the name of the food you would get in a bakery in Novalja" }
    ];
    
    // Solution data
    const solutions = {
      // Across solutions
      "1A": "SUR",
      "4A": "GHOSTING",
      "5A": "WESANDERSON",
      "8A": "JOHNNYENGLISH",
      "10A": "CINEMAPARADISO",
      "13A": "PINGUIN",
      "15A": "LUCIJA",
      "17A": "WETDREAMS",
      "19A": "HURKACZ",
      "22A": "BUZZCUT",
      "23A": "PEPE",
      
      // Down solutions
      "1D": "SURF",
      "2D": "LROFTSERA",
      "3D": "RAPUNZEL",
      "7D": "IYAZA",
      "9D": "TSIPFEL",
      "11D": "DIZDARICA",
      "12D": "SISO",
      "13D": "POFFERTJES",
      "14D": "CARMEL",
      "15D": "LUCIJABI",
      "18D": "MERK",
      "20D": "BABA",
      "21D": "PICA",
    };
    
    // Initialize the grid
    const grid = document.getElementById('crosswordGrid');
    const cells = [];
    
    // Create cells
    for (let i = 0; i < gridData.length; i++) {
      cells[i] = [];
      for (let j = 0; j < gridData[i].length; j++) {
        const cell = document.createElement('div');
        cell.className = 'cell';
        
        if (gridData[i][j] === null) {
          cell.classList.add('black');
        } else {
          const input = document.createElement('input');
          input.type = 'text';
          input.maxLength = 1;
          input.className = 'input-cell';
          input.dataset.row = i;
          input.dataset.col = j;
          cell.appendChild(input);
          
          // Add cell number if needed
          const numberedCell = numberedCells.find(nc => nc.row === i && nc.col === j);
          if (numberedCell) {
            const numberSpan = document.createElement('span');
            numberSpan.className = 'number';
            numberSpan.textContent = numberedCell.across || numberedCell.down;
            cell.appendChild(numberSpan);
          }
        }
        
        grid.appendChild(cell);
        cells[i][j] = cell;
      }
    }
    
    // Populate clues
    const acrossCluesContainer = document.getElementById('acrossClues');
    const downCluesContainer = document.getElementById('downClues');
    
    acrossClues.forEach(clue => {
      const clueElement = document.createElement('div');
      clueElement.className = 'clue';
      clueElement.dataset.number = clue.number;
      clueElement.dataset.direction = 'across';
      clueElement.innerHTML = `<span class="clue-number">${clue.number}.</span> ${clue.clue}`;
      acrossCluesContainer.appendChild(clueElement);
    });
    
    downClues.forEach(clue => {
      const clueElement = document.createElement('div');
      clueElement.className = 'clue';
      clueElement.dataset.number = clue.number;
      clueElement.dataset.direction = 'down';
      clueElement.innerHTML = `<span class="clue-number">${clue.number}.</span> ${clue.clue}`;
      downCluesContainer.appendChild(clueElement);
    });
    
    // Game state
    let currentDirection = 'across';
    let currentCell = null;
    let currentNumber = null;
    
    // Event handlers
    function handleCellClick(event) {
      const input = event.target;
      if (!input.classList.contains('input-cell')) return;
      
      const row = parseInt(input.dataset.row);
      const col = parseInt(input.dataset.col);
      
      // Toggle direction if clicking the same cell
      if (currentCell === input) {
        currentDirection = currentDirection === 'across' ? 'down' : 'across';
      }
      
      selectCell(row, col);
      input.focus();
    }
    
    function handleClueClick(event) {
      const clue = event.target.closest('.clue');
      if (!clue) return;
      
      const number = parseInt(clue.dataset.number);
      const direction = clue.dataset.direction;
      
      // Find the first cell of this clue
      const cell = numberedCells.find(nc => nc[direction] === number);
      if (cell) {
        currentDirection = direction;
        selectCell(cell.row, cell.col);
        const input = cells[cell.row][cell.col].querySelector('input');
        if (input) input.focus();
      }
    }
    
    function handleKeyDown(event) {
      if (!currentCell) return;
      
      const input = currentCell;
      const row = parseInt(input.dataset.row);
      const col = parseInt(input.dataset.col);
      
      switch (event.key) {
        case 'ArrowUp':
          moveToCell(row - 1, col);
          event.preventDefault();
          break;
        case 'ArrowDown':
          moveToCell(row + 1, col);
          event.preventDefault();
          break;
        case 'ArrowLeft':
          moveToCell(row, col - 1);
          event.preventDefault();
          break;
        case 'ArrowRight':
          moveToCell(row, col + 1);
          event.preventDefault();
          break;
        case 'Tab':
          // Move to next/previous clue
          if (event.shiftKey) {
            moveToPreviousClue();
          } else {
            moveToNextClue();
          }
          event.preventDefault();
          break;
        case 'Backspace':
          if (input.value === '') {
            // Move to previous cell if current cell is empty
            if (currentDirection === 'across') {
              moveToCell(row, col - 1);
            } else {
              moveToCell(row - 1, col);
            }
            event.preventDefault();
          }
          break;
        default:
          if (/^[a-zA-Z]$/.test(event.key)) {
            // Automatically move to next cell after input
            setTimeout(() => {
              if (currentDirection === 'across') {
                moveToCell(row, col + 1);
              } else {
                moveToCell(row + 1, col);
              }
            }, 10);
          }
      }
    }
    
    function handleInput(event) {
      const input = event.target;
      input.value = input.value.toUpperCase();
    }
    
    function selectCell(row, col) {
      // Clear previous highlights
      clearHighlights();
      
      // Get the input element
      const cell = cells[row]?.[col];
      if (!cell || cell.classList.contains('black')) return;
      
      const input = cell.querySelector('input');
      if (!input) return;
      
      currentCell = input;
      
      // Find the clue number for this cell
      const numberedCell = numberedCells.find(nc => {
        if (currentDirection === 'across' && nc.across) {
          return row === nc.row && col >= nc.col && !isBlackCell(row, nc.col - 1);
        } else if (currentDirection === 'down' && nc.down) {
          return col === nc.col && row >= nc.row && !isBlackCell(nc.row - 1, col);
        }
        return false;
      });
      
      if (numberedCell) {
        currentNumber = numberedCell[currentDirection];
        
        // Highlight the clue
        const clue = document.querySelector(`.clue[data-number="${currentNumber}"][data-direction="${currentDirection}"]`);
        if (clue) {
          clue.classList.add('clue-selected');
          clue.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        // Highlight all cells in the current word
        highlightCurrentWord(numberedCell, row, col);
      }
      
      // Highlight the current cell
      cell.classList.add('highlight-current');
    }
    
    function moveToCell(row, col) {
      if (row >= 0 && row < gridData.length && col >= 0 && col < gridData[0].length) {
        if (!isBlackCell(row, col)) {
          selectCell(row, col);
          const input = cells[row][col].querySelector('input');
          if (input) input.focus();
        }
      }
    }
    
    function moveToNextClue() {
      let nextClue;
      
      if (currentDirection === 'across') {
        nextClue = acrossClues.find(c => c.number > currentNumber);
        if (!nextClue) {
          nextClue = downClues[0];
          currentDirection = 'down';
        }
      } else {
        nextClue = downClues.find(c => c.number > currentNumber);
        if (!nextClue) {
          nextClue = acrossClues[0];
          currentDirection = 'across';
        }
      }
      
      if (nextClue) {
        const cell = numberedCells.find(nc => nc[currentDirection] === nextClue.number);
        if (cell) {
          selectCell(cell.row, cell.col);
          const input = cells[cell.row][cell.col].querySelector('input');
          if (input) input.focus();
        }
      }
    }
    
    function moveToPreviousClue() {
      let prevClues, lastClue;
      
      if (currentDirection === 'across') {
        prevClues = acrossClues.filter(c => c.number < currentNumber);
        if (prevClues.length === 0) {
          // Switch to end of down clues
          prevClues = downClues;
          currentDirection = 'down';
        }
      } else {
        prevClues = downClues.filter(c => c.number < currentNumber);
        if (prevClues.length === 0) {
          // Switch to end of across clues
          prevClues = acrossClues;
          currentDirection = 'across';
        }
      }
      
      if (prevClues.length > 0) {
        lastClue = prevClues[prevClues.length - 1];
        const cell = numberedCells.find(nc => nc[currentDirection] === lastClue.number);
        if (cell) {
          selectCell(cell.row, cell.col);
          const input = cells[cell.row][cell.col].querySelector('input');
          if (input) input.focus();
        }
      }
    }
    
    function isBlackCell(row, col) {
      if (row < 0 || row >= gridData.length || col < 0 || col >= gridData[0].length) return true;
      return gridData[row][col] === null;
    }
    
    function clearHighlights() {
      // Clear cell highlights
      document.querySelectorAll('.cell').forEach(cell => {
        cell.classList.remove('highlight', 'highlight-current');
      });
      
      // Clear clue highlights
      document.querySelectorAll('.clue').forEach(clue => {
        clue.classList.remove('clue-selected');
      });
    }
    
    function highlightCurrentWord(numberedCell, currentRow, currentCol) {
      if (currentDirection === 'across') {
        // Highlight all cells in the same row until hitting a black cell or edge
        let col = numberedCell.col;
        while (col < gridData[0].length && !isBlackCell(currentRow, col)) {
          cells[currentRow][col].classList.add('highlight');
          col++;
        }
      } else {
        // Highlight all cells in the same column until hitting a black cell or edge
        let row = numberedCell.row;
        while (row < gridData.length && !isBlackCell(row, currentCol)) {
          cells[row][currentCol].classList.add('highlight');
          row++;
        }
      }
    }
    
    function checkAnswers() {
      const inputs = document.querySelectorAll('.input-cell');
      inputs.forEach(input => {
        const row = parseInt(input.dataset.row);
        const col = parseInt(input.dataset.col);
        
        // Find the solution key
        for (const numberedCell of numberedCells) {
          if (numberedCell.across) {
            // Check across solutions
            if (row === numberedCell.row && col >= numberedCell.col) {
              const offset = col - numberedCell.col;
              const solution = solutions[`${numberedCell.across}A`];
              if (solution && offset < solution.length) {
                const correctLetter = solution[offset];
                if (input.value.toUpperCase() !== correctLetter) {
                  input.style.color = 'red';
                } else {
                  input.style.color = 'green';
                }
              }
            }
          }
          
          if (numberedCell.down) {
            // Check down solutions
            if (col === numberedCell.col && row >= numberedCell.row) {
              const offset = row - numberedCell.row;
              const solution = solutions[`${numberedCell.down}D`];
              if (solution && offset < solution.length) {
                const correctLetter = solution[offset];
                if (input.value.toUpperCase() !== correctLetter) {
                  input.style.color = 'red';
                } else {
                  input.style.color = 'green';
                }
              }
            }
          }
        }
      });
    }
    
    function revealAnswers() {
      const inputs = document.querySelectorAll('.input-cell');
      inputs.forEach(input => {
        const row = parseInt(input.dataset.row);
        const col = parseInt(input.dataset.col);
        
        // Find the solution key
        for (const numberedCell of numberedCells) {
          if (numberedCell.across) {
            // Check across solutions
            if (row === numberedCell.row && col >= numberedCell.col) {
              const offset = col - numberedCell.col;
              const solution = solutions[`${numberedCell.across}A`];
              if (solution && offset < solution.length) {
                input.value = solution[offset];
                input.style.color = 'blue';
              }
            }
          }
          
          if (numberedCell.down) {
            // Check down solutions
            if (col === numberedCell.col && row >= numberedCell.row) {
              const offset = row - numberedCell.row;
              const solution = solutions[`${numberedCell.down}D`];
              if (solution && offset < solution.length) {
                input.value = solution[offset];
                input.style.color = 'blue';
              }
            }
          }
        }
      });
    }
    
    function clearPuzzle() {
      const inputs = document.querySelectorAll('.input-cell');
      inputs.forEach(input => {
        input.value = '';
        input.style.color = '';
      });
    }
    
    // Event listeners
    grid.addEventListener('click', handleCellClick);
    document.addEventListener('keydown', handleKeyDown);
    document.addEventListener('input', handleInput);
    acrossCluesContainer.addEventListener('click', handleClueClick);
    downCluesContainer.addEventListener('click', handleClueClick);
    
    // Button actions
    document.getElementById('checkButton').addEventListener('click', checkAnswers);
    document.getElementById('revealButton').addEventListener('click', revealAnswers);
    document.getElementById('clearButton').addEventListener('click', clearPuzzle);
    
    // Initialize with first cell selected
    const firstCell = numberedCells[0];
    selectCell(firstCell.row, firstCell.col);
  </script>
</body>
</html>
